// ============================================================
// FastOS — Stage 2: Windows 11-Style Desktop (ADead-BIB)
// ============================================================
// Loaded at 0x8000 by stage1. Runs in 16-bit real mode.
// Renders a full Windows 11-style desktop using direct VGA
// memory writes at 0xB800:0000 (segment:offset).
//
// Layout (80x25 VGA text mode):
//   Row 0:     (desktop area)
//   Row 1-22:  Desktop with 6 icons in 2 columns
//   Row 23:    (desktop area)
//   Row 24:    Taskbar (centered Start, Search, system tray)
//
// Login → Desktop → Q=Shutdown
// ADead-BIB generates ALL bytes. Zero ASM.
// ============================================================

// ---- Set video mode 03h (80x25 color text) ----
raw { 0xB4, 0x00 }
raw { 0xB0, 0x03 }
int_call(0x10)

// ---- Hide cursor ----
raw { 0xB4, 0x01 }
raw { 0xB9, 0x20, 0x00 }
int_call(0x10)

// ---- Set ES = 0xB800 (VGA text segment) ----
raw { 0xB8, 0x00, 0xB8 }
raw { 0x8E, 0xC0 }

// ============================================================
// LOGIN SCREEN — Windows 11 style (dark, centered, minimal)
// ============================================================

// Fill screen: dark blue-black (0x17 = white on dark blue)
raw { 0xBF, 0x00, 0x00 }
raw { 0xB9, 0xD0, 0x07 }
raw { 0xB8, 0x20, 0x17 }
raw { 0xF3, 0xAB }

// ---- User avatar circle at row 7, col 38 (centered) ----
// (7*80+37)*2 = 1194 = 0x04AA
raw { 0xBF, 0xAA, 0x04 }
raw { 0x26, 0xC7, 0x05, 0x28, 0x1B }  // (
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x02, 0x1B }  // smiley ☺
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x29, 0x1B }  // )

// ---- "Admin" at row 9, col 37 (bright white) ----
// (9*80+37)*2 = 1514 = 0x05EA
raw { 0xBF, 0xEA, 0x05 }
raw { 0x26, 0xC7, 0x05, 0x41, 0x1F }  // A
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x64, 0x1F }  // d
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6D, 0x1F }  // m
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x69, 0x1F }  // i
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6E, 0x1F }  // n

// ---- Password field at row 11, cols 30-49 (dark box) ----
// (11*80+30)*2 = 1820 = 0x071C
raw { 0xBF, 0x1C, 0x07 }
raw { 0xB9, 0x14, 0x00 }  // 20 chars
raw { 0xB8, 0xFE, 0x78 }  // ■ dark grey on grey (password dots look)
raw { 0xF3, 0xAB }

// ---- "Password" hint at row 11, col 32 (grey text on grey bg) ----
// (11*80+32)*2 = 1824 = 0x0720
raw { 0xBF, 0x20, 0x07 }
raw { 0x26, 0xC7, 0x05, 0x50, 0x78 }  // P
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x61, 0x78 }  // a
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x73, 0x78 }  // s
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x73, 0x78 }  // s
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x77, 0x78 }  // w
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6F, 0x78 }  // o
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x72, 0x78 }  // r
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x64, 0x78 }  // d

// ---- Arrow button → at row 11, col 50 ----
// (11*80+50)*2 = 1860 = 0x0744
raw { 0xBF, 0x44, 0x07 }
raw { 0x26, 0xC7, 0x05, 0x1A, 0x3F }  // → white on cyan

// ---- "Sign in" hint at row 13, col 35 (grey) ----
// (13*80+35)*2 = 2150 = 0x0866
raw { 0xBF, 0x66, 0x08 }
raw { 0x26, 0xC7, 0x05, 0x53, 0x18 }  // S
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x69, 0x18 }  // i
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x67, 0x18 }  // g
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6E, 0x18 }  // n
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x20, 0x17 }  // ' '
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x69, 0x18 }  // i
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6E, 0x18 }  // n

// ---- Bottom: power icon at row 24, col 76 ----
// (24*80+76)*2 = 4072 = 0x0FE8
raw { 0xBF, 0xE8, 0x0F }
raw { 0x26, 0xC7, 0x05, 0x0F, 0x1C }  // ☼ (power icon, red)

// ---- "FastOS" at row 24, col 2 (subtle branding) ----
// (24*80+2)*2 = 3844 = 0x0F04
raw { 0xBF, 0x04, 0x0F }
raw { 0x26, 0xC7, 0x05, 0x46, 0x18 }  // F
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x61, 0x18 }  // a
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x73, 0x18 }  // s
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x74, 0x18 }  // t
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x4F, 0x18 }  // O
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x53, 0x18 }  // S

// ---- Wait for any key to "sign in" ----
raw { 0xB4, 0x00 }
int_call(0x16)

// ============================================================
// DESKTOP — Windows 11 Style
// ============================================================
// Color scheme:
//   Desktop bg: 0x1F (white on blue) — clean blue wallpaper
//   Taskbar:    0x8F (white on dark grey) — Win11 dark taskbar
//   Icons:      0x1E (yellow on blue) icon + 0x1F (white on blue) label
//   System tray: 0x87 (grey on dark grey)

// ---- Clear screen: blue desktop wallpaper ----
raw { 0xBF, 0x00, 0x00 }
raw { 0xB9, 0xD0, 0x07 }
raw { 0xB8, 0x20, 0x9F } // bright white on light blue (Win11 feel)
raw { 0xF3, 0xAB }

// ---- Taskbar: rows 23-24 (dark grey, Win11 centered style) ----
// Row 23: thin separator line
// (23*80)*2 = 3680 = 0x0E60
raw { 0xBF, 0x60, 0x0E }
raw { 0xB9, 0x50, 0x00 }
raw { 0xB8, 0xC4, 0x87 } // thin line, grey on dark grey
raw { 0xF3, 0xAB }

// Row 24: main taskbar
raw { 0xBF, 0x00, 0x0F }
raw { 0xB9, 0x50, 0x00 }
raw { 0xB8, 0x20, 0x8F } // white on dark grey
raw { 0xF3, 0xAB }

// ---- Centered Start button (Win11 style) at row 24, col 33 ----
// (24*80+33)*2 = 3906 = 0x0F42
raw { 0xBF, 0x42, 0x0F }
raw { 0x26, 0xC7, 0x05, 0xFE, 0x8B }  // ■ cyan on dark grey
raw { 0x83, 0xC7, 0x02 }

// ---- Search icon at col 35 ----
raw { 0x26, 0xC7, 0x05, 0x20, 0x8F }  // space
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x4F, 0x87 }  // O (search lens)
raw { 0x83, 0xC7, 0x02 }

// ---- "Search" text at col 37 ----
raw { 0x26, 0xC7, 0x05, 0x53, 0x87 }  // S
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x65, 0x87 }  // e
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x61, 0x87 }  // a
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x72, 0x87 }  // r
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x63, 0x87 }  // c
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x68, 0x87 }  // h

// ---- Taskbar app icons at col 44-48 ----
// (24*80+44)*2 = 3928 = 0x0F58
raw { 0xBF, 0x58, 0x0F }
raw { 0x26, 0xC7, 0x05, 0x20, 0x8F }  // space
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x3E, 0x8A }  // > (terminal, green)
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x20, 0x8F }  // space
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x07, 0x8E }  // • (files, yellow)
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x20, 0x8F }  // space

// ---- System tray: right side (col 70-79) ----
// (24*80+70)*2 = 3980 = 0x0F8C
raw { 0xBF, 0x8C, 0x0F }
raw { 0x26, 0xC7, 0x05, 0x18, 0x87 }  // ↑ (network)
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x0D, 0x87 }  // ♪ (sound)
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x20, 0x8F }  // space
raw { 0x83, 0xC7, 0x02 }

// "12:00" clock
raw { 0x26, 0xC7, 0x05, 0x31, 0x8F }  // 1
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x32, 0x8F }  // 2
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x3A, 0x87 }  // :
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x30, 0x8F }  // 0
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x30, 0x8F }  // 0

// ============================================================
// Desktop Icons — 2 columns, 3 rows (Win11 style)
// ============================================================
// Column 1: col 3-12,  Column 2: col 16-25
// Row groups: rows 2-4, rows 7-9, rows 12-14
// Each icon: symbol on row N, label on row N+1

// ---- Icon 1: Documents (row 2, col 5) ----
// Symbol: folder icon at (2*80+6)*2 = 332 = 0x014C
raw { 0xBF, 0x4C, 0x01 }
raw { 0x26, 0xC7, 0x05, 0x07, 0x9E }  // • yellow on blue
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0xDB, 0x9E }  // █ yellow folder
// Label: "Documents" at (3*80+3)*2 = 486 = 0x01E6
raw { 0xBF, 0xE6, 0x01 }
raw { 0x26, 0xC7, 0x05, 0x44, 0x9F }  // D
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6F, 0x9F }  // o
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x63, 0x9F }  // c
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x75, 0x9F }  // u
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6D, 0x9F }  // m
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x65, 0x9F }  // e
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6E, 0x9F }  // n
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x74, 0x9F }  // t
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x73, 0x9F }  // s

// ---- Icon 2: Downloads (row 2, col 18) ----
// Symbol at (2*80+19)*2 = 358 = 0x0166
raw { 0xBF, 0x66, 0x01 }
raw { 0x26, 0xC7, 0x05, 0x19, 0x9B }  // ↓ cyan arrow
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0xDB, 0x9B }  // █ cyan
// Label at (3*80+16)*2 = 512 = 0x0200
raw { 0xBF, 0x00, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x44, 0x9F }  // D
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6F, 0x9F }  // o
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x77, 0x9F }  // w
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6E, 0x9F }  // n
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6C, 0x9F }  // l
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6F, 0x9F }  // o
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x61, 0x9F }  // a
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x64, 0x9F }  // d
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x73, 0x9F }  // s

// ---- Icon 3: Terminal (row 7, col 5) ----
// Symbol at (7*80+6)*2 = 1132 = 0x046C
raw { 0xBF, 0x6C, 0x04 }
raw { 0x26, 0xC7, 0x05, 0x3E, 0x9A }  // > green prompt
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x5F, 0x9A }  // _ green cursor
// Label at (8*80+3)*2 = 1286 = 0x0506
raw { 0xBF, 0x06, 0x05 }
raw { 0x26, 0xC7, 0x05, 0x54, 0x9F }  // T
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x65, 0x9F }  // e
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x72, 0x9F }  // r
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6D, 0x9F }  // m
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x69, 0x9F }  // i
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6E, 0x9F }  // n
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x61, 0x9F }  // a
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6C, 0x9F }  // l

// ---- Icon 4: Files (row 7, col 18) ----
// Symbol at (7*80+19)*2 = 1158 = 0x0486
raw { 0xBF, 0x86, 0x04 }
raw { 0x26, 0xC7, 0x05, 0xDB, 0x9E }  // █ yellow
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0xDB, 0x9E }  // █ yellow
// Label at (8*80+17)*2 = 1314 = 0x0522
raw { 0xBF, 0x22, 0x05 }
raw { 0x26, 0xC7, 0x05, 0x46, 0x9F }  // F
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x69, 0x9F }  // i
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6C, 0x9F }  // l
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x65, 0x9F }  // e
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x73, 0x9F }  // s

// ---- Icon 5: Settings (row 12, col 5) ----
// Symbol at (12*80+6)*2 = 1932 = 0x078C
raw { 0xBF, 0x8C, 0x07 }
raw { 0x26, 0xC7, 0x05, 0x0F, 0x97 }  // ☼ grey gear
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x0F, 0x97 }  // ☼ grey gear
// Label at (13*80+3)*2 = 2086 = 0x0826
raw { 0xBF, 0x26, 0x08 }
raw { 0x26, 0xC7, 0x05, 0x53, 0x9F }  // S
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x65, 0x9F }  // e
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x74, 0x9F }  // t
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x74, 0x9F }  // t
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x69, 0x9F }  // i
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6E, 0x9F }  // n
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x67, 0x9F }  // g
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x73, 0x9F }  // s

// ---- Icon 6: Calculator (row 12, col 18) ----
// Symbol at (12*80+19)*2 = 1958 = 0x07A6
raw { 0xBF, 0xA6, 0x07 }
raw { 0x26, 0xC7, 0x05, 0xDB, 0x9F }  // █ white
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x3D, 0x9F }  // = white
// Label at (13*80+17)*2 = 2114 = 0x0842
raw { 0xBF, 0x42, 0x08 }
raw { 0x26, 0xC7, 0x05, 0x43, 0x9F }  // C
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x61, 0x9F }  // a
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6C, 0x9F }  // l
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x63, 0x9F }  // c

// ============================================================
// Desktop info panel — right side (row 17-20, col 50-76)
// ============================================================
// "FastOS Desktop" title at (17*80+55)*2 = 2830 = 0x0B0E
raw { 0xBF, 0x0E, 0x0B }
raw { 0x26, 0xC7, 0x05, 0x46, 0x9B }  // F cyan
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x61, 0x9B }  // a
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x73, 0x9B }  // s
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x74, 0x9B }  // t
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x4F, 0x9B }  // O
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x53, 0x9B }  // S

// "64-bit" at (18*80+57)*2 = 2994 = 0x0BB2
raw { 0xBF, 0xB2, 0x0B }
raw { 0x26, 0xC7, 0x05, 0x36, 0x97 }  // 6
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x34, 0x97 }  // 4
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x2D, 0x97 }  // -
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x62, 0x97 }  // b
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x69, 0x97 }  // i
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x74, 0x97 }  // t

// "FsOS Format" at (19*80+55)*2 = 3150 = 0x0C4E
raw { 0xBF, 0x4E, 0x0C }
raw { 0x26, 0xC7, 0x05, 0x46, 0x97 }  // F
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x73, 0x97 }  // s
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x4F, 0x97 }  // O
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x53, 0x97 }  // S

// "ADead-BIB" at (20*80+54)*2 = 3308 = 0x0CEC
raw { 0xBF, 0xEC, 0x0C }
raw { 0x26, 0xC7, 0x05, 0x41, 0x98 }  // A dark grey
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x44, 0x98 }  // D
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x65, 0x98 }  // e
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x61, 0x98 }  // a
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x64, 0x98 }  // d
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x2D, 0x98 }  // -
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x42, 0x98 }  // B
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x49, 0x98 }  // I
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x42, 0x98 }  // B

// ============================================================
// Desktop event loop — wait for keys
// ============================================================
raw { 0xB4, 0x00 }
int_call(0x16)

// Check 'q' or 'Q' → shutdown
raw { 0x3C, 0x71 }       // cmp al, 'q'
raw { 0x74, 0x06 }       // je shutdown (+6)
raw { 0x3C, 0x51 }       // cmp al, 'Q'
raw { 0x74, 0x02 }       // je shutdown (+2)

// Any other key → loop back
raw { 0xEB, 0xF2 }       // jmp short -14

// ============================================================
// Shutdown screen — elegant dark
// ============================================================
// Clear screen dark
raw { 0xBF, 0x00, 0x00 }
raw { 0xB9, 0xD0, 0x07 }
raw { 0xB8, 0x20, 0x07 }
raw { 0xF3, 0xAB }

// Spinning circle at row 10, col 39
// (10*80+39)*2 = 1678 = 0x068E
raw { 0xBF, 0x8E, 0x06 }
raw { 0x26, 0xC7, 0x05, 0x4F, 0x0B }  // O (cyan circle)

// "Shutting down..." at row 12, col 31
// (12*80+31)*2 = 1982 = 0x07BE
raw { 0xBF, 0xBE, 0x07 }
raw { 0x26, 0xC7, 0x05, 0x53, 0x0F }  // S
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x68, 0x0F }  // h
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x75, 0x0F }  // u
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x74, 0x0F }  // t
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x74, 0x0F }  // t
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x69, 0x0F }  // i
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6E, 0x0F }  // n
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x67, 0x0F }  // g
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x20, 0x07 }  // ' '
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x64, 0x0F }  // d
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6F, 0x0F }  // o
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x77, 0x0F }  // w
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x6E, 0x0F }  // n
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x2E, 0x08 }  // .
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x2E, 0x08 }  // .
raw { 0x83, 0xC7, 0x02 }
raw { 0x26, 0xC7, 0x05, 0x2E, 0x08 }  // .

// Halt
cli
hlt
raw { 0xEB, 0xFE }
